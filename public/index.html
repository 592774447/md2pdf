<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown è½¬ PDF å·¥å…·</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ“</text></svg>">
    <link rel="stylesheet" href="/css/style.css">
    <link id="themeLink" rel="stylesheet" href="/css/theme-vue.css">
    <style>
        .theme-switcher {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theme-picker {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .theme-btn {
            width: 38px;
            height: 38px;
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 6px;
            background: transparent;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 4px;
            outline: none;
        }

        .theme-btn .swatch {
            width: 22px;
            height: 22px;
            border-radius: 4px;
            display: block;
        }

        .theme-btn.active {
            box-shadow: 0 0 0 3px rgba(97, 175, 239, 0.18);
            transform: translateY(-1px);
        }

        .theme-btn[data-theme="none"] .swatch {
            background: #6B60BE;
            box-shadow: inset 0 0 0 2px #cddbe6;
        }

        .theme-btn[data-theme="theme-vue.css"] .swatch {
            background: #41b883;
            box-shadow: inset 0 0 0 2px #cddbe6;
        }

        .theme-btn[data-theme="theme-atom.css"] .swatch {
            background: #2b2b2b;
            box-shadow: inset 0 0 0 2px #cddbe6;
        }

        .theme-btn[data-theme="theme-minimal.css"] .swatch {
            background: #6D5291;
            box-shadow: inset 0 0 0 2px #cddbe6;
        }

        .theme-btn:focus {
            box-shadow: 0 0 0 3px rgba(97, 175, 239, 0.12);
        }
    </style>
    <script src="/libs/markdown-it.min.js"></script>
    <script src="/libs/mermaid.min.js" defer></script>
    <script id="mathjax-config">
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']] },
            options: { skipHtmlTags: ['noscript', 'style', 'textarea', 'pre'] },
            svg: { fontCache: 'global' },
            startup: { typeset: false }
        };
    </script>
    <script src="/libs/tex-mml-svg.js" defer></script>
</head>

<body>
    <div class="container">
        <header class="header">
            <h1 class="title">ğŸ“ Markdown è½¬ PDF å·¥å…·</h1>
            <p class="subtitle">ä¸“ä¸šçš„ Markdown æ–‡æ¡£è½¬æ¢å·¥å…·ã€æ”¯æŒä¸»é¢˜ã€Mermaid å›¾è¡¨ã€æ•°å­¦å…¬å¼</p>
            <div class="browser-notice">
                âš ï¸ è¯·ä½¿ç”¨ Chrome æˆ– Edge æµè§ˆå™¨ä»¥è·å¾—æœ€ä½³ä½“éªŒ
            </div>
            <div class="theme-switcher">
                <label style="color:inherit; font-weight:600; margin-right:8px;">ä¸»é¢˜</label>
                <div id="themePicker" class="theme-picker" role="list">
                    <button class="theme-btn" data-theme="none" title="é»˜è®¤" aria-label="é»˜è®¤ä¸»é¢˜">
                        <span class="swatch"></span>
                    </button>
                    <button class="theme-btn" data-theme="theme-atom.css" title="æš—è‰²" aria-label="Atom ä¸»é¢˜">
                        <span class="swatch"></span>
                    </button>
                    <button class="theme-btn" data-theme="theme-vue.css" title="æ¸…æ–°" aria-label="Vue ä¸»é¢˜">
                        <span class="swatch"></span>
                    </button>
                    <button class="theme-btn" data-theme="theme-minimal.css" title="æ·¡ç´«" aria-label="Minimal ä¸»é¢˜">
                        <span class="swatch"></span>
                    </button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <section class="upload-section">
                <div class="upload-card">
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">ğŸ“„</div>
                        <p class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½ Markdown æ–‡ä»¶åˆ°æ­¤å¤„</p>
                        <p class="upload-hint">ä»…æ”¯æŒ .md æ ¼å¼æ–‡ä»¶</p>
                        <input type="file" id="fileInput" accept=".md,text/markdown" class="visually-hidden">
                    </div>
                    <div class="file-info" id="fileInfo" style="display: none;">
                        <div class="file-name" id="fileName"></div>
                        <button class="btn-remove" id="removeFile">âœ• ç§»é™¤</button>
                    </div>
                </div>
            </section>

            <section class="config-section">
                <h2 class="section-title">ğŸ¨ å¯¼å‡ºé…ç½®</h2>

                <div class="config-grid">
                    <div class="config-item">
                        <label class="config-label">
                            <span class="label-text">ä¸»é¢˜çš„é£æ ¼</span>
                            <span class="label-desc">é€‰æ‹© PDF çš„ä¸»é¢˜é£æ ¼</span>
                        </label>
                        <select id="theme" class="config-select">
                            <option value="vue">ğŸ’š Vue æ˜äº®é£æ ¼</option>
                            <option value="atom">ğŸŒ‘ Atom æš—è‰²é£æ ¼</option>
                            <option value="light">â˜€ï¸ Light æ˜äº®é£æ ¼</option>
                            <option value="github">ğŸ± GitHub æ˜äº®é£æ ¼</option>
                            <option value="monokai">ğŸŒƒ Monokai æš—è‰²é£æ ¼</option>
                            <option value="solarized">ğŸŒŒ Solarized æš—è‰²é£æ ¼</option>
                        </select>
                    </div>

                    <div class="config-item">
                        <label class="config-label" id="pageInputLabel">
                            <span class="label-text" id="pageInputLabelText">é¡µé¢å®½åº¦ (mm)</span>
                            <span class="label-desc" id="pageInputLabelDesc">è®¾ç½® PDF é¡µé¢çš„å®½åº¦</span>
                        </label>
                        <div style="position:relative;min-height:40px;">
                            <input type="number" id="pageWidth" class="config-input" value="300" min="200" max="1000"
                                step="10" style="position:absolute;top:0;left:0;width:100%;">
                            <select id="pageFormat" class="config-input"
                                style="display:none;position:absolute;top:0;left:0;width:100%;">
                                <option value="A0">ğŸ“„ A0 (841Ã—1189mm)</option>
                                <option value="A1">ğŸ“„ A1 (594Ã—841mm)</option>
                                <option value="A2">ğŸ“„ A2 (420Ã—594mm)</option>
                                <option value="A3">ğŸ“„ A3 (297Ã—420mm)</option>
                                <option value="A4">ğŸ“„ A4 (210Ã—297mm)</option>
                                <option value="A5">ğŸ“„ A5 (148Ã—210mm)</option>
                                <option value="A6">ğŸ“„ A6 (105Ã—148mm)</option>
                                <option value="Legal">ğŸ“„ Legal (216Ã—356mm)</option>
                                <option value="Letter">ğŸ“„ Letter (216Ã—279mm)</option>
                                <option value="Ledger">ğŸ“„ Ledger (432Ã—279mm)</option>
                                <option value="Tabloid">ğŸ“„ Tabloid (279Ã—432mm)</option>
                            </select>
                        </div>
                    </div>

                    <div class="config-item">
                        <label class="config-label">
                            <span class="label-text">ç¼©æ”¾å› å­</span>
                            <span class="label-desc">æ§åˆ¶ PDF å†…å®¹æ¸…æ™°åº¦</span>
                        </label>
                        <input type="number" id="scaleFactor" class="config-input" value="2" min="1" max="4" step="1">
                    </div>

                    <div class="config-item">
                        <label class="config-label">
                            <span class="label-text">è§†å£åˆ†è¾¨ç‡</span>
                            <span class="label-desc">æ¸²æŸ“ PDF æ—¶çš„åˆ†è¾¨ç‡</span>
                        </label>
                        <select id="resolution" class="config-select">
                            <option value="1K">1K (1920x1080)</option>
                            <option value="2K" selected>2K (2560x1440)</option>
                            <option value="4K">4K (3840x2160)</option>
                        </select>
                    </div>

                    <div class="config-item">
                        <label class="config-label">
                            <span class="label-text">é¡µé¢è¾¹è· (mm)</span>
                            <span class="label-desc">è®¾ç½® PDF çš„é¡µé¢è¾¹è·</span>
                        </label>
                        <input type="number" id="margin" class="config-input" value="0" min="0" max="50" step="5">
                    </div>

                    <div class="config-item">
                        <label class="config-label">
                            <span class="label-text">å¼ºåˆ¶å•é¡µ</span>
                            <span class="label-desc">å¯¼å‡º PDF ä¸ºå•é¡µæ¨¡å¼</span>
                        </label>
                        <label class="switch">
                            <input type="checkbox" id="forceSinglePage" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </section>

            <section class="image-section" id="imageSection" style="display: none;">
                <h2 class="section-title">ğŸ–¼ï¸ å›¾ç‰‡ä¸Šä¼ </h2>
                <div class="image-card">
                    <div id="imageList"></div>
                    <div class="upload-image-area">
                        <button class="btn btn-upload-image" id="uploadImageBtn">
                            ğŸ“¤ ä¸Šä¼ å›¾ç‰‡
                        </button>
                        <input type="file" id="imageInput" accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
                            multiple class="visually-hidden">
                    </div>
                </div>
            </section>

            <section class="preview-section">
                <div class="action-bar">
                    <button class="btn btn-preview" id="previewBtn" disabled>
                        ğŸ‘ï¸ é¢„è§ˆ
                    </button>
                    <button class="btn btn-generate" id="generateBtn" disabled>
                        ğŸš€ ç”Ÿæˆ PDF
                    </button>
                </div>

                <div class="preview-container" id="previewContainer" style="display: none;">
                    <div class="preview-header">
                        <h3>ğŸ“„ é¢„è§ˆ</h3>
                        <button class="btn-close" id="closePreview">âœ•</button>
                    </div>
                    <div class="preview-content" id="previewContent"></div>
                </div>

                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p class="progress-text" id="progressText">æ­£åœ¨ç”Ÿæˆ PDF...</p>
                    <button id="cancelBtn" class="btn-cancel" style="display:none;">å–æ¶ˆ</button>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p class="author">æš—è‰²ä¸»é¢˜ã€å¼ºåˆ¶å•é¡µã€ç¼©æ”¾å› å­ã€è§†å£åˆ†è¾¨ç‡ã€è¶…é•¿çš„æ–‡æ¡£åŠå®½åº¦ã€å¤§é‡çš„å›¾è¡¨åŠå…¬å¼ç­‰ã€å‡ä¼šå¤§å¹…å¢åŠ æ¸²æŸ“è€—æ—¶ã€è¯·è€å¿ƒç­‰å¾…æ¸²æŸ“ç»“æŸ</p>
        </footer>
    </div>

    <script src="/js/app.js"></script>
    <script>
        (function () {
            try {
                const link = document.getElementById('themeLink');
                const picker = document.getElementById('themePicker');
                const saved = localStorage.getItem('md2pdf_theme') || 'none';

                function applyTheme(name) {
                    if (!link) return;
                    if (name === 'none') {
                        link.disabled = true;
                    } else {
                        link.disabled = false;
                        link.href = '/css/' + name;
                    }
                }

                function setActiveButton(name) {
                    if (!picker) return;
                    Array.from(picker.querySelectorAll('.theme-btn')).forEach(btn => {
                        btn.classList.toggle('active', btn.getAttribute('data-theme') === name);
                    });
                }

                applyTheme(saved);
                setActiveButton(saved);

                if (picker) {
                    picker.addEventListener('click', function (e) {
                        const btn = e.target.closest('.theme-btn');
                        if (!btn) return;
                        const theme = btn.getAttribute('data-theme') || 'none';
                        try { localStorage.setItem('md2pdf_theme', theme); } catch (e) { }
                        applyTheme(theme);
                        setActiveButton(theme);
                    });
                    picker.addEventListener('keydown', function (e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            const btn = e.target.closest('.theme-btn');
                            if (btn) { btn.click(); e.preventDefault(); }
                        }
                    });
                }
            } catch (e) { console.warn('theme switch init failed', e) }
        })();
    </script>
</body>

</html>
